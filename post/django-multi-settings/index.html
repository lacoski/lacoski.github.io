<!DOCTYPE html>
<html class="no-js" lang="en-US" prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#">
<head>
    <meta charset="utf-8">

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="description" content="">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="keywords" content="Django, Python, ">

 
<meta property="og:type" content="article"/>
<meta property="og:description" content=""/>
<meta property="og:title" content="Cấu hình multi settings Django : spf13.com"/>
<meta property="og:site_name" content="spf13 is Steve Francia"/>
<meta property="og:image" content="" />
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="" />
<meta property="og:image:height" content="" />
<meta property="og:url" content="https://lacoski.github.io/post/django-multi-settings/">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2018-10-25"/>
<meta property="article:modified_time" content="2018-10-25"/>



<meta property="article:tag" content="Django">
<meta property="article:tag" content="Python">




<meta name="twitter:card" content="summary">

<meta name="twitter:site" content="@spf13">
<meta name="twitter:title" content="Cấu hình multi settings Django : spf13.com">
<meta name="twitter:creator" content="@spf13">
<meta name="twitter:description" content="">
<meta name="twitter:image:src" content="">
<meta name="twitter:domain" content="spf13.com">



    <base href="https://lacoski.github.io/">
    <title> Cấu hình multi settings Django - spf13.com </title>
    <link rel="canonical" href="https://lacoski.github.io/post/django-multi-settings/">
    

    <link href='http://fonts.googleapis.com/css?family=Fjalla+One|Open+Sans:300' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/static/css/style.css">

    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" />
</head>

<body lang="en" itemscope itemtype="http://schema.org/Article">
<header id="header">
    <figure>
      <a href="/" border=0 id="logolink"><div class="icon-spf13-3" id="logo"> </div></a>
    </figure>
    <div id="byline">by Steve Francia</div>
    <nav id="nav">
            <ul id="mainnav">
            <li>
                <a href="/post/">
                <span class="icon"> <i aria-hidden="true" class="icon-quill"></i></span>
                <span> blog </span>
            </a>
            </li>
            <li>
            <a href="/project/">
                <span class="icon"> <i aria-hidden="true" class="icon-console"></i></span>
                <span> code </span>
            </a>
            </li>
            <li>
            <a href="/presentation/">
                <span class="icon"> <i aria-hidden="true" class="icon-stats"></i></span>
                <span> talks </span>
            </a>
            </li>
            <li>
            <a href="http://stevefrancia.com">
                <span class="icon"> <i aria-hidden="true" class="icon-13"></i></span>
                <span> me </span>
            </a>
            </li>
        </ul>

            <ul id="social">
            <li id="share">
                <span class="icon icon-bubbles"> </span>
                <span class="title"> share </span>
                <div class="dropdown share">
                    <ul class="social">
                      <li> <a href="https://twitter.com/intent/tweet?status=C%e1%ba%a5u%20h%c3%acnh%20multi%20settings%20Django-https%3a%2f%2flacoski.github.io%2fpost%2fdjango-multi-settings%2f" target="_blank" title="Follow me on Twitter" class="twitter"><span class="icon icon-twitter"></span>Twitter</a> </li>
                        <li> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2flacoski.github.io%2fpost%2fdjango-multi-settings%2f" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>
                        <li> <a href="https://plus.google.com/share?url=https%3a%2f%2flacoski.github.io%2fpost%2fdjango-multi-settings%2f" target="_blank" title="Google+" class="googleplus"><span class="icon icon-google-plus"></span>Google+</a> </li>
                        <li> <a href="http://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2flacoski.github.io%2fpost%2fdjango-multi-settings%2f&title=C%e1%ba%a5u%20h%c3%acnh%20multi%20settings%20Django&source=spf13" target="_blank" title="LinkedIn" class="linkedin"><span class="icon icon-linkedin"></span>LinkedIn</a> </li>
                        <li> <a href="http://del.icio.us/post?url=https%3a%2f%2flacoski.github.io%2fpost%2fdjango-multi-settings%2f" target="_blank" title="Delicious" class="delicious"><span class="icon icon-delicious"></span>Delicious</a> </li>
                        <li> <a href="http://www.reddit.com/submit?url=https%3a%2f%2flacoski.github.io%2fpost%2fdjango-multi-settings%2f" target="_blank" title="Reddit" class="reddit"><span class="icon icon-reddit"></span>Reddit</a> </li>
                        <li> <a href="http://www.stumbleupon.com/submit?url=https%3a%2f%2flacoski.github.io%2fpost%2fdjango-multi-settings%2f" target="_blank" title="StumbleUpon" class="stumbleupon"><span class="icon icon-stumbleupon"></span>StumbleUpon</a> </li>
                    </ul>
                    <span class="subcount">sharing is caring</span>
                </div>
            </li>
            <li id="follow">
                <span class="icon icon-rocket"> </span>
                <span class="title"> follow </span>
                <div class="dropdown follow">
                    <ul class="social">                        
                        <li> <a href="https://www.facebook.com/" target="_blank" title="Join me on Facebook" class="facebook"><span class="icon icon-facebook"></span>Facebook</a> </li>                        
                        <li> <a href="https://github.com/lacoski" target="_blank" title="GitHub" class="github"><span class="icon icon-github"></span>GitHub</a> </li>                        
                    </ul>
                    <span class="subcount">join 10k+ subscribers &amp; followers</span>
                </div>
            </li>
        </ul>

    </nav>
</header>



<section id="main">
  <h1 itemprop="name" id="title">Cấu hình multi settings Django</h1>
  <div>
        <article itemprop="articleBody" id="content">
           

<h1 id="cách-sử-dụng-nhiều-môi-trường-khác-nhau-trên-django">Cách sử dụng nhiều môi trường khác nhau trên Django</h1>

<hr />

<h2 id="cấu-trúc-cũ-của-project">Cấu trúc cũ của project:</h2>

<pre><code>project/
 |-- project/
 |    |-- __init__.py
 |    |-- settings.py
 |    |-- urls.py
 |    +-- wsgi.py
 +-- manage.py
</code></pre>

<h2 id="cấu-trúc-multi-setting-django">Cấu trúc multi setting django</h2>

<h3 id="chỉnh-sửa-cấu-trúc-thư-mục">Chỉnh sửa cấu trúc thư mục</h3>

<pre><code>project/
 |-- project/
 |    |-- __init__.py
 |    |-- settings/         &lt;--
 |    |    |-- __init__.py  &lt;-- Khởi tạo thư mục
 |    |    +-- base.py      &lt;-- Khởi tại file base settings
 |    |-- urls.py
 |    +-- wsgi.py
 +-- manage.py
</code></pre>

<ul>
<li><code>base.py</code>: Cung cấp các setting thông thường cho tất cả môi trường</li>
</ul>

<h3 id="thêm-mới-các-env">Thêm mới các env</h3>

<p>Các file setting thông dụng
- development.py
- production.py
- staging.py</p>

<pre><code>project/
 |-- project/
 |    |-- __init__.py
 |    |-- settings/
 |    |    |-- __init__.py
 |    |    |-- base.py
 |    |    |-- development.py
 |    |    |-- production.py
 |    |    +-- staging.py
 |    |-- urls.py
 |    +-- wsgi.py
 +-- manage.py
</code></pre>

<h3 id="tổ-chức-cấu-hình">Tổ chức cấu hình</h3>

<h4 id="settings-base-py">settings/base.py</h4>

<pre><code>&quot;&quot;&quot;
Django settings for project project.

Generated by 'django-admin startproject' using Django 2.1.1.

For more information on this file, see
https://docs.djangoproject.com/en/2.1/topics/settings/

For the full list of settings and their values, see
https://docs.djangoproject.com/en/2.1/ref/settings/
&quot;&quot;&quot;

import os

# Build paths inside the project like this: os.path.join(BASE_DIR, ...)
BASE_DIR = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))


# Quick-start development settings - unsuitable for production
# See https://docs.djangoproject.com/en/2.1/howto/deployment/checklist/

# SECURITY WARNING: keep the secret key used in production secret!
SECRET_KEY = '8%f@_cwa_w_ol_b5g7y44-=hc@76he@jzb^1)^^ahv%v4#3jj0'

# SECURITY WARNING: don't run with debug turned on in production!
DEBUG = True

ALLOWED_HOSTS = []


# Application definition

INSTALLED_APPS = [    
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'authen.apps.AuthenConfig',
]

.....

STATIC_URL = '/static/'

AUTH_USER_MODEL = 'authen.User'
</code></pre>

<h4 id="settings-development-py">settings/development.py</h4>

<pre><code>from .base import *

DEBUG = True

INSTALLED_APPS += [
    'debug_toolbar',
]

MIDDLEWARE += ['debug_toolbar.middleware.DebugToolbarMiddleware', ]

EMAIL_BACKEND = 'django.core.mail.backends.console.EmailBackend'

DEBUG_TOOLBAR_CONFIG = {
    'JQUERY_URL': '',
}
</code></pre>

<h4 id="settings-development-py-1">settings/development.py</h4>

<pre><code>from .base import *

DEBUG = False

ALLOWED_HOSTS = ['mysite.com', ]

CACHES = {
    'default': {
        'BACKEND': 'django.core.cache.backends.memcached.MemcachedCache',
        'LOCATION': '127.0.0.1:11211',
    }
}

EMAIL_BACKEND = 'django.core.mail.backends.smtp.EmailBackend'
EMAIL_HOST = 'smtp.mailgun.org'
EMAIL_PORT = 587
EMAIL_HOST_USER = config('EMAIL_HOST_USER')
EMAIL_HOST_PASSWORD = config('EMAIL_HOST_PASSWORD')
EMAIL_USE_TLS = True
</code></pre>

<h3 id="chạy-project-lựa-chọn-env">Chạy project lựa chọn env</h3>

<pre><code>python manage.py runserver --settings=mysite.settings.development

python manage.py migrate --settings=mysite.settings.production
</code></pre>

<h3 id="chạy-manager-py-mặc-định">Chạy <code>manager.py</code> mặc định</h3>

<p>Với yêu cầu chạy env theo dạng:</p>

<pre><code>python manage.py migrate
python manage.py runserver
</code></pre>

<p>Truy cập <code>manage.py</code></p>

<pre><code>#!/usr/bin/env python
import os
import sys

if __name__ == '__main__':
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'project.settings') # &lt;-- Change here!
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            &quot;Couldn't import Django. Are you sure it's installed and &quot;
            &quot;available on your PYTHONPATH environment variable? Did you &quot;
            &quot;forget to activate a virtual environment?&quot;
        ) from exc
    execute_from_command_line(sys.argv)
</code></pre>

<p>Sửa lại</p>

<pre><code>#!/usr/bin/env python
import os
import sys

if __name__ == '__main__':
    os.environ.setdefault('DJANGO_SETTINGS_MODULE', 'project.settings.production') # &lt;-- Change here!
    try:
        from django.core.management import execute_from_command_line
    except ImportError as exc:
        raise ImportError(
            &quot;Couldn't import Django. Are you sure it's installed and &quot;
            &quot;available on your PYTHONPATH environment variable? Did you &quot;
            &quot;forget to activate a virtual environment?&quot;
        ) from exc
    execute_from_command_line(sys.argv)
</code></pre>

<h3 id="xử-lý-bài-toán-mỗi-env-có-sự-khác-biệt-về-venv-python">Xử lý bài toán mỗi env có sự khác biệt về venv python</h3>

<p>Tách file requirements.txt thành thư mục, khi sử dụng env nào pip install lại venv tương tự</p>

<pre><code>└── requirements
    ├── base.txt
    ├── local.txt
    ├── production.txt
    └── test.txt
</code></pre>

<h2 id="debug-in-vscode">Debug in vscode</h2>

<pre><code>{
    &quot;name&quot;: &quot;Python: Django Production&quot;,
    &quot;type&quot;: &quot;python&quot;,
    &quot;request&quot;: &quot;launch&quot;,
    &quot;pythonPath&quot;: &quot;${workspaceFolder}/src/env/bin/python&quot;,
    &quot;program&quot;: &quot;${workspaceFolder}/src/project/manage.py&quot;,
    &quot;console&quot;: &quot;integratedTerminal&quot;,
    &quot;args&quot;: [
        &quot;runserver&quot;,
        &quot;--noreload&quot;,
        &quot;--nothreading&quot;,
        &quot;--settings=project.settings.production&quot;
    ],
    &quot;django&quot;: true
},
{
    &quot;name&quot;: &quot;Python: Django Test&quot;,
    &quot;type&quot;: &quot;python&quot;,
    &quot;request&quot;: &quot;launch&quot;,
    &quot;pythonPath&quot;: &quot;${workspaceFolder}/src/env/bin/python&quot;,
    &quot;program&quot;: &quot;${workspaceFolder}/src/project/manage.py&quot;,
    &quot;console&quot;: &quot;integratedTerminal&quot;,
    &quot;args&quot;: [
        &quot;runserver&quot;,
        &quot;--noreload&quot;,
        &quot;--nothreading&quot;,
        &quot;--settings=project.settings.testing&quot;
    ],
    &quot;django&quot;: true
},
</code></pre>

<h1 id="nguồn">Nguồn</h1>

<p><a href="https://blog.apptension.com/2017/11/09/django-settings-for-multiple-environments/">https://blog.apptension.com/2017/11/09/django-settings-for-multiple-environments/</a></p>

<p><a href="https://simpleisbetterthancomplex.com/tips/2017/07/03/django-tip-20-working-with-multiple-settings-modules.html">https://simpleisbetterthancomplex.com/tips/2017/07/03/django-tip-20-working-with-multiple-settings-modules.html</a></p>

<p><a href="https://medium.com/@ayarshabeer/django-best-practice-settings-file-for-multiple-environments-6d71c6966ee2">https://medium.com/@ayarshabeer/django-best-practice-settings-file-for-multiple-environments-6d71c6966ee2</a></p>

        </article>
  </div>
</section>



<aside id="meta">

    <div>
        <section id="datecount">
          <h4 id="date"> Thu Oct 25, 2018 </h4>
          <h5 id="wc"> 600 Words </h5>
          <h5 id="readtime"> Read in about 3 Min </h5>
        </section>
        <ul id="categories">
          
            <li><a href="https://lacoski.github.io//topics/django">Django</a> </li>
          
            <li><a href="https://lacoski.github.io//topics/python">Python</a> </li>
          
        </ul>
        <ul id="tags">
          
            <li> <a href="https://lacoski.github.io//tags/django">Django</a> </li>
          
        </ul>
    </div>

    <div>
        <section id="prev">
            &nbsp;
        </section><section id="next">
            &nbsp;
        </section>
    </div>

    <div> <section id="author"> <h4>Về tác giả:</h4> 

            <p>
                Mình là Nguyễn Bá Thành, hiện là sinh viên Trường Đại Học Thăng Long, khóa K27, chuyên ngành Mạng và truyền thông.

                Năm 2 đã từng thực tập vị trí Lập Trình Viên ASP.NET MVC 5 Backend khoảng 8 tháng tại công ty ICOMM.
                
                Tới cuối năm 3 mình chuyển sang tìm hiểu về Linux và Network, và may mắn tới hè được nhận vào phòng hệ thống công ty TECAPRO.
                
                Tới cuối năm 4, mình muốn tập trung hơn vào storage nên chuyển sang team HOCCHUDONG và loanh quanh tới hiện tại.
                
                Tới nay, mình cũng đã sắp ra trường và chuẩn bị thất học :D.
            </p>
        </section> </div>

</aside>

<meta itemprop="wordCount" content="571">
<meta itemprop="datePublished" content="2018-10-25">
<meta itemprop="url" content="https://lacoski.github.io/post/django-multi-settings/">



<footer>
  <div>
    <p>
    &copy; 2013-18 <span itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Steve Francia.</span></span>
    <a href="http://creativecommons.org/licenses/by/3.0/" title="Creative Commons Attribution">Some rights reserved</a>;
    please attribute properly and link back. <br>
    Powered by <a href="http://gohugo.io">Hugo</a>.
    </p>
  </div>
</footer>
<script type="text/javascript">
(function(){var j=function(a,b){return window.getComputedStyle?getComputedStyle(a).getPropertyValue(b):a.currentStyle[b]};var k=function(a,b,c){if(a.addEventListener)a.addEventListener(b,c,false);else a.attachEvent('on'+b,c)};var l=function(a,b){for(key in b)if(b.hasOwnProperty(key))a[key]=b[key];return a};window.fitText=function(d,e,f){var g=l({'minFontSize':-1/0,'maxFontSize':1/0},f);var h=function(a){var b=e||1;var c=function(){a.style.fontSize=Math.max(Math.min(a.clientWidth/(b*10),parseFloat(g.maxFontSize)),parseFloat(g.minFontSize))+'px'};c();k(window,'resize',c)};if(d.length)for(var i=0;i<d.length;i++)h(d[i]);else h(d);return d}})();
fitText(document.getElementById('title'), 1)
</script>

<script type="application/javascript">
var dnt = (navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack);
var doNotTrack = (dnt == "1" || dnt == "yes");
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	if (window.sessionStorage) {
		var GA_SESSION_STORAGE_KEY = 'ga:clientId';
		ga('create', 'UA-7131036-1', {
	    'storage': 'none',
	    'clientId': sessionStorage.getItem(GA_SESSION_STORAGE_KEY)
	   });
	   ga(function(tracker) {
	    sessionStorage.setItem(GA_SESSION_STORAGE_KEY, tracker.get('clientId'));
	   });
   }
	ga('set', 'anonymizeIp', true);
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</body>
</html>

